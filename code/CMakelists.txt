# code/CMakeLists.txt
cmake_minimum_required(VERSION 3.10)
find_package(Qt6 REQUIRED COMPONENTS Widgets)

# --- Core Library ---
add_library(gridlock_core
    core/Node.cpp
    core/Edge.cpp
    core/City.cpp
    core/Agent.cpp
    core/RoutePlanner.cpp
    core/SimulationController.cpp
    core/Metrics.cpp
    core/Preset.cpp
    core/CongestionAwarePolicy.cpp
    core/ShortestPathPolicy.cpp
)

target_include_directories(gridlock_core PUBLIC
    ${CMAKE_CURRENT_SOURCE_DIR}/core
    ${CMAKE_CURRENT_SOURCE_DIR}/adapters
    ${CMAKE_CURRENT_SOURCE_DIR}/ui
)

# --- Adapters ---
add_library(gridlock_adapters
    adapters/JsonReader.cpp
    adapters/PresetLoader.cpp
    adapters/ReportWriter.cpp
    adapters/TimerService.cpp
)
target_include_directories(gridlock_adapters PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/adapters)
target_link_libraries(gridlock_adapters gridlock_core)

# --- Qt UI (stub for now) ---
add_executable(gridlock_ui
    ui/main.cpp
    ui/GridView.cpp
    ui/MainWindow.cpp
    ui/MetricsPanel.cpp
)
target_link_libraries(gridlock_ui PRIVATE gridlock_core gridlock_adapters Qt6::Widgets)

# --- Tests ---
add_executable(test_city tests/test_city.cpp)
target_link_libraries(test_city PRIVATE gridlock_core gridlock_adapters)
